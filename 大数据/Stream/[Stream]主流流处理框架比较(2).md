---
layout: post
author: 侠天
title: Stream 主流流处理框架比较(2)
date: 2018-01-10 16:31:01
tags:
  - Stream

categories: Stream
---

在上篇文章中，我们过了下基本的理论，也介绍了主流的流处理框架：`Storm`，`Trident`，`Spark Streaming`，`Samza`和`Flink`。今天咱们来点有深度的主题，比如，容错，状态管理或者性能。除此之外，我们也将讨论开发分布式流处理应用的指南，并给出推荐的流处理框架。

### 1. 容错性

流处理系统的`容错性`与生俱来的比批处理系统难实现。当批处理系统中出现错误时，我们只需要把失败的部分简单重启即可；但对于流处理系统，出现错误就很难恢复。因为线上许多作业都是`7 x 24`小时运行，不断有输入的数据。流处理系统面临的另外一个挑战是`状态一致性`，因为重启后会出现重复数据，并且不是所有的状态操作是幂等的。容错性这么难实现，那下面我们看看各大主流流处理框架是如何处理这一问题。

#### 1.1 Apache Storm

`Storm`使用`上游数据备份`和`消息确认`的机制来保障消息在失败之后会重新处理。消息确认原理：每个操作都会把前一次的操作处理消息的确认信息返回。`Topology`的数据源备份它生成的所有数据记录。当所有数据记录的处理确认信息收到，备份即会被安全拆除。失败后，如果不是所有的消息处理确认信息收到，那数据记录会被数据源数据替换。这保障了没有数据丢失，但数据结果会有重复，这就是`at-least once`传输机制。

`Storm`采用取巧的办法完成了容错性，对每个源数据记录仅仅要求几个字节存储空间来跟踪确认消息。纯数据记录消息确认架构，尽管性能不错，但不能保证`exactly once`消息传输机制，所有应用开发者需要处理重复数据。`Storm`存在低吞吐量和流控问题，因为消息确认机制在反压下经常误认为失败。


























原文:http://www.infoq.com/cn/articles/comparison-of-main-stream-processing-framework-part02?utm_source=infoq&utm_campaign=user_page&utm_medium=link
