在实际开发中经常会遇到一些有时效的数据，比如限时优惠活动，缓存或验证码等，过了一定时间就需要删除这些数据．在关系性数据库中一般需要额外的一个字段记录到期时间，然后定期检测删除过期数据．而在Redis中可以使用`EXPIRE`命令设置一个键的生存时间，到期之后Redis会自动删除它．

### 1. 设置生存时间

```
EXPIRE key seconds
```
其中seconds参数表示键的生存时间，单位为秒

例如，如果想让session:29da34键在1分钟后被删除：
```
127.0.0.1:6379> SET session:29da34 yoona
OK
127.0.0.1:6379> EXPIRE session:29da34 900
(integer) 1
127.0.0.1:6379> GET session:29da34
"yoona"
```
==说明==

`EXPIRE`命令返回1表示设置成功，返回0表示键不存在或设置失败.

如果之前设置过生存时间，再次使用`EXPIRE`命令会修改其生存时间：
```
127.0.0.1:6379> EXPIRE foo 60
(integer) 1
127.0.0.1:6379> TTL foo
(integer) 58
127.0.0.1:6379> EXPIRE foo 10
(integer) 1
127.0.0.1:6379> TTL foo
(integer) 8

```

### 2. 查看生存时间

如果想知道一个键还有多久时间会被删除，可以使用`TTL`命令，返回值是键的剩余时间，单位为秒：
```
127.0.0.1:6379> TTL session:29da34
(integer) 877
127.0.0.1:6379> TTL session:29da34
(integer) 858
127.0.0.1:6379> TTL session:29da34
(integer) 666
127.0.0.1:6379> TTL session:29da34
(integer) 100
127.0.0.1:6379> TTL session:29da34
(integer) -2

```
可见随着时间的不同，`session:29da34`键的生存时间逐渐减少，900秒后会被删除．当键不存在时`TTL`命令会返回-2．

==备注==

当　key　不存在时，返回 -2 。 当 key 存在但没有设置剩余生存时间时，返回 -1 。 否则，以秒为单位，返回 key 的剩余生存时间。
在 Redis 2.8 以前，当 key 不存在，或者 key 没有设置剩余生存时间时，命令都返回 -1 。
```
127.0.0.1:6379> GET foo
(nil)
127.0.0.1:6379> TTL yoo
(integer) -2
127.0.0.1:6379> SET yoo yoona
OK
127.0.0.1:6379> TTL yoo
(integer) -1
```

### 3. 清除生存时间

如果想取消键的生存时间设置，可以使用`PERSIST`命令．如果生存时间被成功的清除则返回1，否则返回0：
```
127.0.0.1:6379> EXPIRE foo 20
(integer) 1
127.0.0.1:6379> GET foo
"bar"
127.0.0.1:6379> PERSIST foo
(integer) 1
127.0.0.1:6379> TTL foo
(integer) -1
```
除此之外，可以使用`SET`命令为键重新赋值，同时也能清除键的生存时间：
```
127.0.0.1:6379> EXPIRE foo 60
(integer) 1
127.0.0.1:6379> TTL foo
(integer) 56
127.0.0.1:6379> SET foo yoona
OK
127.0.0.1:6379> TTL foo
(integer) -1
```

### 4. 更细粒度时间控制

`EXPIRE`命令的`seconds`参数必须是整数，所以最小单位是1秒．如果想要更精确的控制键的生存时间可以使用`PEXPIRE`命令，唯一的区别是前者的时间单位是秒，后者的时间单位是毫秒．对应的使用`PTTL`命令以毫秒为单位返回键的剩余时间．

